<!--
  This template loads for the 'tab.friend-detail' state (app.js)
  'friend' is a $scope variable created in the FriendsCtrl controller (controllers.js)
  The FriendsCtrl pulls data from the Friends service (service.js)
  The Friends service returns an array of friend data
-->
<ion-view view-title="{{effort.title}} - Tasks">
	
  <ion-content >
  <div ng-include src="'templates/effort-tabs.html'"></div>
  <ion-list>
      <div>
          <form name="addTaskForm" ng-submit="addTask()" novalidate >
            <ion-list>
                <ion-item class="item item-input-inset">
                  <div class="item-input-wrapper" >
                    <input type="text" placeholder="New Task" ng-model="data.title" required >
                  </div>
                  <button class="button button-positive" ng-click="showForm = true;" ng-disabled="data.submitted || addTaskForm.$invalid" >
                    <i class="icon ion-plus"></i>
                  </button>                    
                </ion-item>
            </ion-list>
        </form>
    </div>
    <div class="item item-icon-left item-icon-right task item-text-wrap"  ng-repeat="task in data.tasks track by $index" >
      <div class="icon" ng-hide="task.editable">
          <button class="button button-light button-small" ng-click="changeStatus( effort.id , $index , task.guid );" >
            <i class="ion-close" ng-show="task.finished" ></i>
          </button>                
      </div>
      <div class="icon" ng-show="task.editable && self.role == 'admin'">
        <button class="button button-assertive button-small ion-trash-b" ng-click="data.tasks[ $index ].deleteTask = true;" >
        </button>                
      </div>
      <input type="text" ng-model="task.title" ng-focus="task.editable = true;" ng-blur="task.editable = false; changeTask(  effort.id , $index , task.guid )" required >
      <div class="item-toggle" >
        <label class="toggle toggle-calm task" ng-show="task.available && !task.finished" >          
           <input type="checkbox" ng-model="task.dibs" ng-checked="task.dibs" ng-click="dibs( effort.id , task.guid )">               
           <div class="track">
             <div class="handle"></div>
           </div>
        </label>     
      </div>
    </div>   
  </ion-list>
  </ion-content>
</ion-view>
